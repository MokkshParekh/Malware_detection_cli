rule MSFvenom_Meterpreter_ReverseTCP
{
    meta:
        description = "Detects msfvenom generated Meterpreter Reverse TCP payload"
        author = "Your Name"
        date = "2024-09-01"
        reference = "Generated using msfvenom"
        hash = "<your_file_hash_here>"

    strings:
        $s1 = { fc e8 82 00 00 00 60 89 e5 31 c0 64 8b 50 30 8b 52 0c 8b 52 14 }
        $s2 = "This program cannot be run in DOS mode"
        $s3 = "Reverse TCP"
    
    condition:
        uint16(0) == 0x5a4d and filesize < 200KB and all of them
}
